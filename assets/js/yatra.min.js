!function(a){var s,t=(s=jQuery,{init:function(){this.cacheDom(),this.bindEvents(),this.initLib()},cacheDom:function(){this.$booking_form=s("#yatra-tour-booking-form-fields"),this.$yatra_update_cart=s(".yatra_update_cart")},bindEvents:function(){var n=this;this.$booking_form.on("submit",function(t){t.preventDefault(),s(this).attr("data-tour-id");var a=s(this).serialize();n.bookTour(a)}),s("body").on("click",".yatra_update_cart",function(t){t.preventDefault();var a=s(this).closest("form").serialize();n.update_cart(a,s(this))}),s("body").on("click","table.yatra_cart_table input.yatra-number-of-person-field",function(t){t.preventDefault(),s(this).closest(".yatra_cart_table").find(".yatra_update_cart").removeAttr("disabled")}),s("body").on("click",".yatra-itinerary-list-item .itinerary-heading svg, .yatra-itinerary-list-item .itinerary-heading .fa, .yatra-faq-list-item .faq-heading svg, .yatra-faq-list-item .faq-heading .fa",function(){s(this).hasClass("fa-minus")?n.toggleYatraList(s(this),"close"):n.toggleYatraList(s(this),"open")}),s("body").on("click",".yatra-tab-content .tab-title svg, .yatra-tab-content .tab-title .fa",function(){var t=s(this),a=s('<span class=""/>'),e=t.closest("h3");t.hide();var i="close";t.hasClass("fa-minus")?(i="close",a.addClass("fa fa-plus")):(i="open",a.addClass("fa fa-minus")),s.each(t.closest(".yatra-tab-content").find("ul.yatra-list li.yatra-list-item .yatra-heading"),function(){var t=s(this).find(".icon");0<t.length&&n.toggleYatraList(t,i)}),e.append(a),t.remove()})},initLib:function(){"undefined"!=typeof s().select2&&s(".yatra-select2").select2(),"undefined"!=typeof s().datepicker&&s(".yatra-date").datepicker()},toggleYatraList:function(t,a){"open"==a?this.listToggleOpen(t):this.listToggleClose(t)},listToggleOpen:function(t){t.closest("li.yatra-list-item").find(".yatra-content").slideDown("slow");var a=s('<span class="icon fa fa-minus"/>'),e=t.closest("h4");t.hide(),e.append(a),t.remove()},listToggleClose:function(t){t.closest("li.yatra-list-item").find(".yatra-content").slideUp("slow");var a=s('<span class="icon fa fa-plus"/>'),e=t.closest("h4");t.hide(),e.append(a),t.remove()},addLoading:function(t){var a=t[0].tagName.toLowerCase();"a"===a||"button"===a?t.text(t.attr("data-loading-text")):t.val(t.attr("data-loading-text"))},removeLoading:function(t){var a=t[0].tagName.toLowerCase();"a"===a||"button"===a?t.text(t.attr("data-text")):t.val(t.attr("data-text"))},update_cart:function(t,a){var e=a.closest("form.yatra-cart-form"),i=this;s.ajax({type:"POST",url:yatra_params.ajax_url,data:t,beforeSend:function(){i.table_loading(a)},success:function(t){!0===t.success&&(e.find(".yatra-cart-table-wrapper").find("table.yatra_cart_table").remove(),e.find(".yatra-cart-table-wrapper").append(t.data)),e.find(".yatra-overlay").remove()},complete:function(){e.find(".yatra-overlay").remove()}})},table_loading:function(t){t.closest("form").append('<div class="yatra-overlay"></div>')},bookTour:function(t){var a=this,e=a.$booking_form.find(".yatra-book-now-btn");s.ajax({type:"POST",url:yatra_params.ajax_url,data:t,beforeSend:function(){a.addLoading(e)},success:function(t){!0===t.success&&(window.location=t.data.cart_page_url)},complete:function(){a.removeLoading(e)}})}});a.fn.YatraTabs=function(t){return this.each(function(){var e,t=a(this);(e=jQuery,{init:function(t){this.cacheDom(t),this.setupAria(),this.bindEvents()},cacheDom:function(){this.$el=t,this.$tabList=this.$el.find("ul.yatra-tab-wrap"),this.$tab=this.$tabList.find("li.item"),this.$tabFirst=this.$tabList.find("li.item:first-child a"),this.$tabLink=this.$tabList.find("li.item > a"),this.$tabPanel=this.$el.find("section"),this.$tabPanelFirstContent=this.$el.find("section > *:first-child"),this.$tabPanelFirst=this.$el.find("section:first-child"),this.$tabPanelNotFirst=this.$el.find("section:not(:first-of-type)")},bindEvents:function(){this.$tabLink.on("click",function(){this.changeTab()}.bind(this)),this.$tabLink.on("keydown",function(){this.changeTabKey()}.bind(this))},changeTab:function(){var t=e(event.target);event.preventDefault(),this.removeTabFocus(),this.setSelectedTab(t),this.hideAllTabPanels(),this.setSelectedTabPanel(t)},changeTabKey:function(){var t=e(event.target),a=this.setKeyboardDirection(t,event.keyCode);a.length&&(this.removeTabFocus(t),this.setSelectedTab(a)),this.hideAllTabPanels(),this.setSelectedTabPanel(e(document.activeElement))},hideAllTabPanels:function(){this.$tabPanel.attr("aria-hidden","true")},removeTabFocus:function(t){this.$el.find('[role="tab"]').attr({tabindex:"-1","data-aria-selected":null}).closest("li").removeClass("active")},selectFirstTab:function(){this.$tabFirst.attr({"data-aria-selected":"true",tabindex:"0"}).closest("li").addClass("active")},setupAria:function(){this.$tabList.attr("role","tablist"),this.$tab.attr("role","presentation"),this.$tabLink.attr({role:"tab",tabindex:"-1"}),this.$tabLink.each(function(){var t=e(this);t.attr("aria-controls",t.attr("href").substring(1))}),this.$tabPanel.attr({role:"tabpanel"}),this.$tabPanelFirstContent.attr({tabindex:"0"}),this.$tabPanelNotFirst.attr({"aria-hidden":"true"}),this.selectFirstTab()},setKeyboardDirection:function(t,a){var e=t.parents("li").prev().children('[role="tab"]'),i=t.parents("li").next().children('[role="tab"]');switch(a){case 37:return e;case 39:return i;default:return!1}},setSelectedTab:function(t){t.attr({"data-aria-selected":!0,tabindex:"0"}).focus().closest("li").addClass("active")},setSelectedTabPanel:function(t){this.$el.find("#"+t.attr("aria-controls")).attr("aria-hidden",null)}}).init(t)}),this},a(document).ready(function(){t.init(),a("#yatra-tour-tabs").YatraTabs(),a("#yatra-tour-sidebar-tabs").YatraTabs()})}(jQuery);